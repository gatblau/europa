---
- name: Copying script to get Id of default terminal profile identifier
  copy:
    src=shell/get_profile_id.sh {{user}}
    dest=/home/{{user}}/get_profile_id.sh
    owner=root
    mode=0755

- name: Creating file with Id of default terminal profile identifier
  command: /home/{{user}}/get_profile_id.sh
  ignore_errors: yes

- name: Setting terminal to run command as login shell
  become_user: "{{user}}"
  shell: "gsettings set org.gnome.Terminal.Legacy.Profile:/org/gnome/terminal/legacy/profiles:/:{{ lookup('file', 'default_profile_id') }}/ login-shell true"
  args:
    chdir: /home/{{user}}/
  ignore_errors: yes

- name: Disabling theme colours in terminal
  become_user: "{{user}}"
  shell: "gsettings set org.gnome.Terminal.Legacy.Profile:/org/gnome/terminal/legacy/profiles:/:{{ lookup('file', 'default_profile_id') }}/ use-theme-colors false"
  args:
    chdir: /home/{{user}}/
  ignore_errors: yes

- name: Removing the file with the Id of default terminal profile identifier
  file:
     dest=/home/{{user}}/default_profile_id
     state=absent
  ignore_errors: yes

- name: Removing the script to get Id of default terminal profile identifier
  file:
     dest=/home/{{user}}/get_profile_id.sh
     state=absent