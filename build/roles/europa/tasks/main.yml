---
- name: Creating the {{group|capitalize}} user group
  group: name="{{group}}" state=present

- name: Creating the {{user|capitalize}} user
  user: name="{{user}}" group="{{group}}"

- name: Copying proxy management functions to host
  copy:
    src=shell/proxy.sh
    dest=/tmp/proxy.sh

- name: Adding proxy management functions to the shell
  shell: cat /tmp/proxy.sh >> .bashrc
  args:
    chdir: /home/{{user}}/

- name: Setting Banner Text with version in Login Screen
  template:
    src=banner/01-banner-message.j2
    dest=/etc/dconf/db/gdm.d/01-banner-message
  tags: gnome

- include: logo.yml
  tags: gnome

- name: Installing Unzip command
  yum:
    name=unzip
    state=present

- name: Installing Multi-language configuration
  yum:
    name=system-config-language
    state=present

- include: rpm.yml
  vars:
    rpm_app_name: "EPEL YUM Repository"
    rpm_filename : epel-release-7-7.noarch.rpm

- name: Installs Yum Utils
  yum:
    name=yum-utils
    state=present

- include: mono.yml

- name: Installing Ruby
  yum:
    name=ruby
    state=present

- include: xscreensaver.yml

- name: Setting up NodeSource YUM repository
  script: node/setup-node-repo.sh

- name: Installing NodeJS
  yum:
    name=nodejs
    state=present

- name: Installing Bower
  command: "npm install -g bower"

- include: background.yml

- include: rpm.yml
  vars:
    rpm_app_name: "Java JDK 8u92-x64"
    rpm_filename : jdk-8u92-linux-x64.rpm

- name: Installing Java Alternative
  command: "alternatives --install /usr/bin/java java /usr/java/default/bin/java 1"

- name: Setting Java Alternative
  command: "alternatives --set java /usr/java/default/bin/java"

- include: rpm.yml
  vars:
    rpm_app_name: DOCKER SELINUX
    rpm_filename: docker-engine-selinux-1.11.2-1.el7.centos.noarch.rpm

- include: rpm.yml
  vars:
    rpm_app_name: DOCKER
    rpm_filename: docker-engine-1.11.2-1.el7.centos.x86_64.rpm

- name: Starting the Docker daemon
  service:
    name=docker
    state=started
    enabled=yes

- name: Updating the user bash profile to elevate rights to run Docker
  lineinfile:
    dest=/home/{{user}}/.bash_profile
    insertafter="# User specific.*"
    line="sudo chmod 0666 /var/run/docker.sock"

- name: Installing Python Package Manager (pip)
  yum:
    name=python-pip
    state=present

- name: Installing Docker Compose
  pip:
    name=docker-compose

- include: rpm.yml
  vars:
    rpm_app_name: GIT Wandisco yum repository
    rpm_filename: wandisco-git-release-7-2.noarch.rpm

- include: rpm.yml
  vars:
    rpm_app_name: GIT_PERL
    rpm_filename: perl-Git-2.8.0-1.WANdisco.308.noarch.rpm

- include: rpm.yml
  vars:
    rpm_app_name: GIT_SCM
    rpm_filename: git-2.8.0-1.WANdisco.308.x86_64.rpm

- name: Installing the MariaDB YUM repository file
  copy:
    src=mariadb/mariadb.repo
    dest=/etc/yum.repos.d/mariadb.repo

- name: Installing MariaDB client tools
  yum:
    name={{item}}
    state=present
  with_items:
    - MariaDB-client

- include: tool.yml
  vars:
    tool_name : Groovy
    folder_name : groovy-2.4.7
    zip_filename: apache-groovy-binary-2.4.7.zip
    add_version_to_folder : false
    zip_has_folder : true
    has_bin_folder : true

- include: rpm.yml
  vars:
    rpm_app_name: Vagrant
    rpm_filename: vagrant_1.8.1_x86_64.rpm

- include: rpm.yml
  vars:
    rpm_app_name: "Chrome Browser"
    rpm_filename : google-chrome-stable_current_x86_64.rpm

- include: tool.yml
  vars:
    tool_name : SBT
    folder_name : sbt-0.13.11
    zip_filename: sbt-0.13.11.zip
    add_version_to_folder : true
    zip_has_folder : true
    has_bin_folder : true

- include: tool.yml
  vars:
    tool_name : Gradle
    folder_name : gradle-2.14
    zip_filename: gradle-2.14-bin.zip
    add_version_to_folder : false
    zip_has_folder : true
    has_bin_folder : true

- include: tool.yml
  vars:
    tool_name : Maven
    folder_name : apache-maven-3.3.9
    zip_filename: apache-maven-3.3.9-bin.zip
    add_version_to_folder : false
    zip_has_folder : true
    has_bin_folder : true

- include: tool.yml
  vars:
    tool_name : Activator
    folder_name : activator-dist-1.3.10
    zip_filename: typesafe-activator-1.3.10.zip
    zip_has_folder : true
    add_version_to_folder : false
    has_bin_folder : false

- name: Making activator executable
  file: path=/usr/local/activator/default/bin/activator mode=a+x

- include: intellij.yml

- include: scalaide.yml
  vars:
    zip_filename: scala-SDK-4.4.1-vfinal-2.11-linux.gtk.x86_64.tar.gz

- include: eclipse.yml
  vars:
    zip_filename: eclipse-jee-neon-R-linux-gtk-x86_64.tar.gz

- include: haroopad.yml
  vars:
    tool_name: HarooPad
    zip_filename: haroopad-v0.13.1-x64.tar.gz

- include: rpm.yml
  vars:
    rpm_app_name: "Atom hackable editor"
    rpm_filename: atom.x86_64.rpm

- include: rpm.yml
  vars:
    rpm_app_name: "My SQL Workbench"
    rpm_filename: mysql-workbench-community-6.3.7-1.el7.x86_64.rpm

- include: tool.yml
  vars:
    tool_name : Robomongo
    folder_name : robomongo-0.9.0-rc9-linux-x86_64-0bb5668
    zip_filename: robomongo-0.9.0-rc9-linux-x86_64-0bb5668.tar.gz
    add_version_to_folder : false
    zip_has_folder : true
    has_bin_folder : true

- name: Copying RoboMongo's GNOME Desktop file
  copy:
    src=robomongo/robomongo.desktop
    dest=/usr/share/applications/robomongo.desktop

- include: origin.yml
  vars:
    filename: openshift-origin-server-v1.3.0-alpha.2-983578e-linux-64bit
    zip_filename: openshift-origin-server-v1.3.0-alpha.2-983578e-linux-64bit.tar.gz

- name: Removing the ansible installation folder
  file:
    dest=/tmp/packer-provisioner-ansible-local
    state=absent
  ignore_errors: yes